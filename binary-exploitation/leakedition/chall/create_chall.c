#include <stdio.h>
#include <stdlib.h>

// gcc -fno-stack-protector -Wl,-z,norelro -no-pie -z execstack chall.c -o chall

void init(){
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);
    setvbuf(stderr, NULL, _IONBF, 0);
}

void logolest(){
	puts("");
    puts("██╗     ███████╗███████╗████████╗    ██████╗  ██████╗ ██████╗ ██╗  ██╗");
    puts("██║     ██╔════╝██╔════╝╚══██╔══╝    ╚════██╗██╔═████╗╚════██╗██║  ██║");
    puts("██║     █████╗  ███████╗   ██║        █████╔╝██║██╔██║ █████╔╝███████║");
    puts("██║     ██╔══╝  ╚════██║   ██║       ██╔═══╝ ████╔╝██║██╔═══╝ ╚════██║");
    puts("███████╗███████╗███████║   ██║       ███████╗╚██████╔╝███████╗     ██║");
    puts("╚══════╝╚══════╝╚══════╝   ╚═╝       ╚══════╝ ╚═════╝ ╚══════╝     ╚═╝");
    puts("                          leak edition");
    puts("");
}

void leak(){
    char buffer[100], flagvar[50];
    FILE *f = fopen("./flag.txt", "rb");
    if (f == NULL) {
        puts("flag.txt not found.");
        exit(0);
    }

    fgets(flagvar, 64, f);      
    fclose(f);

    puts("Give me the flag !");
    printf("$ ");
    fgets(buffer, sizeof(buffer), stdin);
    printf(buffer);
}

int main(void){
    init();
    logolest();
    leak();

    return 0;
}